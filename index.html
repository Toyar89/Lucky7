<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LUCKY 7</title>

<!-- PWA essentials -->
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#17173A" />

<!-- iOS install support -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" href="icon-512.png">

<style>
  :root { --bg:#17173A; --fg:#ffffff; --card:#ffffff; --accent:#ffffff; }

  /* kill 300ms tap delay / ghost clicks on mobile */
html, body, .cards, .card, .card-inner, .card-face {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}


  body {
    font-family: Arial, sans-serif;
    background: var(--bg);
    color: var(--fg);
    margin: 0;
    padding: 20px;
    text-align: center;
  }

  .logo {
    width: clamp(160px, 30vw, 360px);
    height: auto;
    display: block;
    margin: 0 auto 18px;
  }

  .cards {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 12px;
    margin: 20px 0;
  }
  .card-container { perspective: 1000px; }
  .card-inner {
    width: clamp(90px, 12vw, 120px);
    height: clamp(150px, 21vw, 200px);
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
  }
  .card.flipped .card-inner { transform: rotateY(180deg); cursor: default; }
  .card-face {
    position: absolute; width: 100%; height: 100%;
    border-radius: 12px; backface-visibility: hidden;
    display: flex; align-items: center; justify-content: center;
    font-size: clamp(28px, 4vw, 48px); font-weight: bold;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  }
  .card-front { background: royalblue; }
  .card-back  { background: var(--card); color: #000; transform: rotateY(180deg); }
  .position-label { font-size: clamp(14px, 2vw, 18px); margin-top: 6px; color: var(--fg); }

  .scoreboard { display: flex; justify-content: center; gap: 20px; margin-top: 15px; flex-wrap: wrap; }
  .scorebox {
    background: var(--card); color: #000; padding: 10px 20px; border-radius: 8px;
    font-size: 18px; min-width: 100px; font-weight: bold;
  }

  .button-row {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 16px;
    margin-top: 15px;
    flex-wrap: nowrap;
  }

  #gameButton {
    padding: 14px 60px;
    min-width: 220px;
    font-size: 20px;
    font-weight: bold;
    border-radius: 8px;
    background: royalblue;   /* same as card front */
    color: #fff;             /* white text */
    border: none;
    cursor: pointer;
    flex: 0 1 auto;
  }

  #howToPlayButton {
    padding: 14px 40px;
    min-width: 200px;
    font-size: 20px;
    font-weight: bold;
    border-radius: 8px;
    background: var(--bg);
    color: var(--fg);
    border: 2px solid var(--accent);
    cursor: pointer;
    flex: 0 1 auto;
  }
  #howToPlayButton:hover { background: #1e1e45; }

  @media (max-width: 420px) {
    .button-row { gap: 10px; }
    #gameButton { padding: 12px 36px; min-width: 180px; font-size: 18px; }
    #howToPlayButton { padding: 12px 26px; min-width: 150px; font-size: 18px; }
  }

  @keyframes winCardFlash { 0%, 100% { background-color: gold; } 50% { background-color: white; } }
  .winFlash .card-back { animation: winCardFlash 0.4s alternate infinite; }

  @keyframes bustBackgroundFlash {
    0%   { background-color: rgba(255,0,0,0.3); }
    50%  { background-color: rgba(255,0,0,0.9); }
    100% { background-color: rgba(255,0,0,0.3); }
  }
  .card.bustFlash .card-back {
    animation: bustBackgroundFlash 0.6s infinite;
    color: #fff;
  }

  #status { margin-top: 15px; font-size: clamp(16px, 2.4vw, 20px); font-weight: bold; }

  .copyright { font-size: 1em; margin-top: 10px; opacity: 0.8; }

  /* Confetti canvas */
  canvas.confetti { position: fixed; inset: 0; pointer-events: none; }

  /* Floating Install button (only appears when installable) */
  #installPromptBtn {
    display: none;
    position: fixed;
    right: 16px;
    bottom: 16px;
    padding: 12px 16px;
    font-weight: bold;
    border-radius: 10px;
    border: 2px solid #fff;
    background: #17173A;
    color: #fff;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    z-index: 10001;
    cursor: pointer;
  }
  #installPromptBtn:hover { background:#1e1e45; }
</style>
</head>
<body>

<img class="logo" src="logo.png?v=3" alt="Lucky 7"/>

<div class="cards" id="cardContainer"></div>
<div id="status">Pick any card to start.</div>

<div class="button-row">
  <button id="gameButton">Start</button>
  <button id="howToPlayButton" onclick="showHowToPlay()">How to Play</button>
</div>

<div class="scoreboard">
  <div class="scorebox">Won: <span id="winCount">0</span></div>
  <div class="scorebox">Lost: <span id="loseCount">0</span></div>
</div>

<div class="copyright">¬© Kev Shirreffs 2025</div>

<!-- Modal -->
<div id="howToPlayModal">
  <div id="howToPlayContent">
    <h2>How to Play</h2>
    <p>üéØ You have 7 facedown cards numbered <strong>1 to 7</strong> on the front.</p>
    <p>üîÑ The back of each card has a number (also <strong>1 to 7</strong>) in a random order.</p>
    <p>üÉè Start by picking any card.</p>
    <p>üìç The number you reveal tells you which <strong>position</strong> you must flip next.</p>
    <p>üèÜ Reveal <strong>all 7 cards</strong> without repeating a position to win.</p>
    <p>‚ùå If a number points to a card that‚Äôs already face-up, you <strong>bust</strong> and lose.</p>
    <div class="howto-actions">
      <button onclick="closeHowToPlay()">Got it!</button>
    </div>
  </div>
</div>


<!-- Sounds -->
<audio id="winSound"    src="applause.mp3"></audio>
<audio id="bustSound"   src="boom.mp3" preload="auto"></audio>
<audio id="flipSound"   src="bubble.mp3" preload="auto"></audio>

<!-- Floating Install button -->
<button id="installPromptBtn">Install App</button>

<!-- Load external game logic ONLY -->
<script src="app.js" defer></script>
</body>
</html>


